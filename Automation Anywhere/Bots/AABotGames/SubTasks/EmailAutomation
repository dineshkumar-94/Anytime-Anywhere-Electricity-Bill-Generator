{"triggers":[],"nodes":[{"uid":"eddc4f54-69a2-43bc-8ad8-fc667ce14793","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"253ac589-59f6-43b4-a1c1-9125ffa40ce6","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Temp\\TNEB\\IQ BOT\\Config\\MasterData.accdb"}}],"returnTo":{"type":"VARIABLE","variableName":"MasterDataTablePath"}},{"uid":"d88b6e7d-1596-472d-94d8-d9070ee9945a","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Temp\\TNEB\\IQ BOT\\EmailAttachment"}}],"returnTo":{"type":"VARIABLE","variableName":"EmailAttachmentFolder"}},{"uid":"23bedc92-4e4d-44a7-a0e8-303db3ca69cc","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"C:\\Temp\\TNEB\\IQ BOT\\Config\\ConfigData.accdb"}}],"returnTo":{"type":"VARIABLE","variableName":"ConfigFile"}},{"uid":"2d64d5d1-c673-409d-9ddd-2228e156ef61","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$ConfigFile$;Persist Security Info=False;"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4d75bc6c-c5cb-4769-be87-b085ae46d35a","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"MasterData"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$MasterDataTablePath$;Persist Security Info=False;"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6b7febae-7041-42ce-b87d-07cf1c42a700","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6b162ee3-d05c-4369-b65a-44f9d49acf91","commandName":"emailConnect","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"serverHost","value":{"type":"STRING","string":"imap.gmail.com"}},{"name":"port","value":{"type":"NUMBER","number":"993"}},{"name":"username","value":{"type":"STRING","expression":"$EmailUserID$"}},{"name":"securedPassword","value":{"type":"STRING","expression":"$Password$"}},{"name":"useSecure","value":{"type":"BOOLEAN","boolean":true}},{"name":"protocol","value":{"type":"STRING","string":"IMAP"}}]},{"uid":"f47a6579-f2fb-4a9c-88af-b8679d0ba4c8","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"fa5a7077-ae05-43e2-bf40-440da43f03e5","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$EmailDetails{emailSubject}$\n$EmailDetails{emailFrom}$\n$EmailDetails{emailTo}$\n$EmailDetails{emailCc}$\n$EmailDetails{emailBcc}$\n$EmailDetails{emailMessage}$\n$EmailDetails{emailReceivedTime}$\n$EmailDetails{emailReceivedDate}$\n$EmailDetails{emailSentTime}$\n$EmailDetails{emailSentDate}$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"dedd0748-7171-486f-9d8e-edd0b3e12d4b","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$EmailDetails{emailFrom}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":"<"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"OR"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":">"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"EmailFrom"}},{"uid":"25a5bf4d-cfde-45dd-a630-f63b1cb540ff","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$EmailAttachmentFolder$\\$EmailFrom$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"5733fb5a-85be-430c-b105-7497f75e3fd2","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"Insert into [ProcessTracker] ([Date],[EmailReceivedDate],[EmailFrom],[AttachmentPath],[ProcessStartTime],[Status],[Remarks]) values ('$SystemVariablesPackage:CurrentDate$','$EmailDetails{emailReceivedDate}$','$EmailFrom$','$EmailAttachmentFolder$\\$EmailFrom$','$SystemVariablesPackage:CurrentDate$ $SystemVariablesPackage:CurrentTime$','New','Email Completed')"}},{"name":"timeOut","value":{"type":"NUMBER","number":"20"}}]},{"uid":"40b3eaa5-d42b-4f17-9298-12ccaaa2408d","commandName":"saveAttachment","packageName":"Email","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$EmailAttachmentFolder$\\$EmailFrom$"}},{"name":"checkOverrwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"EmailDetails"},"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"EmailSession"}},{"name":"readStatus","value":{"type":"STRING","string":"UNREAD"}},{"name":"folder","value":{"type":"STRING","string":"Inbox"}},{"name":"subject","value":{"type":"STRING","expression":"$EmailSubject$"}},{"name":"from","value":{"type":"STRING","string":""}},{"name":"messageFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"isToUseLocalTimezone","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.email","packageName":"Email"}}]},{"uid":"81adee1d-b066-4b90-a3a5-9bbb5454f6a0","commandName":"closeEmail","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"string":"EmailSession","type":"STRING"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Read Email and Download Attachments"}}]},{"uid":"21aa032b-4b87-4be0-aa6d-480697c4670c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6e2403e0-f6fc-4e68-83a1-21837f6e65aa","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"select * from [ProcessTracker] where [Status]='New' and [Remarks]='Email Completed'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"2aa77471-e9e3-4353-835c-b502b36af10f","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"da742303-527b-4db6-8aa3-5465ddc29971","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$ProcessTrackerNew{EmailFrom}$"}}],"returnTo":{"type":"VARIABLE","variableName":"EmailFrom"}},{"uid":"08d2025b-ec3a-4747-a5fe-1605cf393734","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Non-Registered"}}],"returnTo":{"type":"VARIABLE","variableName":"EmailRegistrationStatus"}},{"uid":"c0ff7245-c7a9-4521-8b70-2dc122b44a8c","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"MasterData"}},{"name":"query","value":{"type":"STRING","expression":"select * from [TNEBMasterData] where [EmailID]='$ProcessTrackerNew{EmailFrom}$'"}},{"name":"fetchSize","value":{"type":"NUMBER","number":"1"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4f645971-cbdf-4e88-b8fa-9d89d0dfe010","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"13ae72a4-7609-43ea-ba32-e4122e68f831","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Registered"}}],"returnTo":{"type":"VARIABLE","variableName":"EmailRegistrationStatus"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"SQLDatasetRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"058328f5-74d8-4fe3-b95c-a756b96744e4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3629b029-6ed6-4367-98a3-1aef11776089","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Rejected (Non-Registered) : Send Email "}}]},{"uid":"3a8e0ffd-e1ac-4b58-aaf2-57b5054a1e35","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"Update [ProcessTracker] set [Status]='Rejected', [Remarks]='Non-Registered Email' where [EmailFrom]='$EmailFrom$' and [Status]='New' and [Remarks]='Email Completed';"}},{"name":"timeOut","value":{"type":"NUMBER","number":"15"}}]}],"branches":[{"uid":"f922abc8-c43b-428b-aaa4-ec87c9998ec1","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"77c5ae63-832c-42b2-a5fb-5bb64c073103","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"Update [ProcessTracker] set [Status]='New', [Remarks]='Registered Email' where [EmailFrom]='$EmailFrom$' and [Status]='New' and [Remarks]='Email Completed'"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$EmailRegistrationStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Registered"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$EmailRegistrationStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Non-Registered"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"ProcessTrackerNew"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Validate Email ID"}}]},{"uid":"4f166e33-a527-4735-af15-6198cb0e12e3","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"c739370a-e942-4f4e-9149-5d4975a71353","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"MasterData"}}]},{"uid":"d8bc7078-c740-417d-8a13-4f21d6f7fed5","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Email ID is $EmailRegistrationStatus$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"branches":[{"uid":"fd68a0b5-76b4-4989-bfdc-53bb29380fbe","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"EmailDetails","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"EmailAttachmentFolder","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"EmailFrom","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ConfigFile","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"ProcessTrackerNew","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"EmailRegistrationStatus","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"SQLDatasetRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"MasterDataTablePath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"EmailUserID","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"Password","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"EmailSubject","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Comment","version":"2.6.0-20210504-152804"},{"name":"Database","version":"3.1.1-20210526-115136"},{"name":"Email","version":"3.6.0-20210504-084515"},{"name":"ErrorHandler","version":"2.6.0-20210504-152835"},{"name":"Folder","version":"4.0.0-20210504-152839"},{"name":"If","version":"3.0.0-20210504-152844"},{"name":"Loop","version":"3.0.0-20210504-152940"},{"name":"MessageBox","version":"3.0.0-20210504-152941"},{"name":"Step","version":"2.0.2-20210504-153452"},{"name":"String","version":"4.1.0-20210427-194725"},{"name":"SystemVariablesPackage","version":"2.0.4-20201005-084352"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM","botCodeVersion":"2"}}